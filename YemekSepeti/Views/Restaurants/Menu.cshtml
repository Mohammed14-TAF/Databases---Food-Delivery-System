@model List<YemekSepeti.Models.MenuItem>

@{
    Layout = "_Layout";
    string restaurantName = ViewBag.RestaurantName ?? "Restaurant";
    string restaurantImage = ViewBag.RestaurantImage ?? "/images/default-restaurant.png";

    var categories = Model.Select(m => m.Category).Distinct().ToList();
}

<!-- ================= RESTAURANT HEADER ================= -->
<div style="
    width:100%; height:280px;
    background:url('@restaurantImage') center/cover no-repeat;
    border-radius:0 0 20px 20px; position:relative;">
    <div style="
        position:absolute; bottom:20px; left:30px;
        background:rgba(0,0,0,0.6); color:white;
        padding:12px 25px; border-radius:8px;
        font-size:28px; font-weight:600;">
        @restaurantName
    </div>
</div>

<div class="container mt-5">

    <!-- ================= FILTER BAR ================= -->
    <div class="filter-bar mb-4 p-3 shadow-sm"
         style="background:#fff; border-radius:15px;">

        <form method="get" class="row">
            <div class="col-md-3 mb-2">
                <select name="category" class="form-control">
                    <option value="">All Categories</option>
                    @foreach (var c in categories)
                    {
                        <option value="@c">@c</option>
                    }
                </select>
            </div>

            <div class="col-md-3 mb-2">
                <select name="sort" class="form-control">
                    <option value="">Sort by</option>
                    <option value="low">Price: Low to High</option>
                    <option value="high">Price: High to Low</option>
                </select>
            </div>

            <div class="col-md-4 mb-2">
                <input class="form-control"
                       name="search"
                       placeholder="Search inside menu..." />
            </div>

            <div class="col-md-2 mb-2">
                <button class="btn btn-warning w-100"
                        style="font-weight:600;">
                    Apply
                </button>
            </div>
        </form>
    </div>

    <!-- ================= MENU GRID ================= -->
    <div class="row">

        @foreach (var item in Model)
        {
            <div class="col-lg-4 col-md-6 col-sm-12 mb-4">

                <div class="card shadow-sm"
                     style="border:none; border-radius:15px; overflow:hidden;">

                    <img src="@item.ImageUrl" class="card-img-top"
                         style="height:220px; object-fit:cover;" />

                    <div class="card-body">

                        <h5 class="card-title" style="font-weight:700;">
                            @item.Name
                        </h5>

                        <p class="card-text" style="color:#555; font-size:14px;">
                            @item.Description
                        </p>

                        <!-- ⭐ RATING -->
                        <div style="color:#FFD700; font-size:18px;">
                            @for (int i = 1; i <= 5; i++)
                            {
                                if (i <= item.Rating)
                                {
                                    <span>★</span>
                                }
                                else
                                {
                                    <span style="color:#ddd;">★</span>
                                }
                            }
                        </div>

                        <!-- CATEGORY TAG -->
                        <span class="badge bg-primary mt-2"
                              style="font-size:14px;">
                            @item.Category
                        </span>

                        <h5 class="mt-3" style="font-weight:700; color:#28a745;">
                            ₺@item.Price
                        </h5>

                        <!-- ✅ FIXED ADD TO CART -->
                        <a asp-controller="Cart"
                           asp-action="AddToCart"
                           asp-route-id="@item.MenuItemID"
                           class="btn btn-warning mt-2 w-100"
                           style="font-weight:600; border-radius:10px;">
                            Add to Cart
                        </a>

                    </div>
                </div>

            </div>
        }

    </div>
</div>
